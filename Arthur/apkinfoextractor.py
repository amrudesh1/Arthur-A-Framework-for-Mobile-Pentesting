from pkg_resources import ExtractionError
import sys
from Arthur import apktool as ap
from Arthur import manfiest_parser as mp


class apk_info_extractor:
    def __init__(self, args):
        self.apk_path = args.APK
        self.apktool = ap.Apktool()
        # self.decompile_apk()
        self.extract_apk_info('Arthur/temp/Sample')

    def decompile_apk(self):
        apktool_status, apk_extracted_path = self.apktool.decompile_apk(
            self.apk_path)
        if apktool_status == 0:
            print("Decompilation Complete....Please wait.....")
            # self.extract_apk_info(apk_extracted_path)
            self.extract_apk_info('Arthur/temp/Sample')
        else:
            print("Decompilation Failed")
            sys.exit(1)

    def extract_apk_info(self, apk_extracted_path):
        mp.manfiest_parser(apk_extracted_path)
